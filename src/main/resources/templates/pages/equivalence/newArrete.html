<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
 <meta charset="utf-8">
 <base href="http://localhost:8080/newArrete" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
        <title>Arrete - Administration Equivalence FOP(67Ha)</title>
        <link rel="shortcut icon" href="assets/dist/img/favicon.png'" type="image/x-icon">
    	<script src="assets/js/webfont.js"></script>
        <script>
            WebFont.load({
                google: {families: ['Raleway:100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i']},
                active: function () {
                    sessionStorage.fonts = true;
                }
            });
        </script>
        <!-- START GLOBAL MANDATORY STYLE -->
        <link href="assets/dist/css/base.css"rel="stylesheet" type="text/css">

		<!-- START PAGE LABEL PLUGINS --> 
        <link href="assets/plugins/summernote/summernote.css" rel="stylesheet" type="text/css"/>
         
        <script src="assets/plugins/jQuery/jquery-1.12.4.min.js"></script>
        <!-- START THEME LAYOUT STYLE -->
        <link href="assets/dist/css/style.css"rel="stylesheet" type="text/css"/>
       
       	<!-- THEME INPUTS -->
       	<link href="assets/plugins/inputs/css/fileinput.css" media="all" rel="stylesheet" type="text/css"/>
       
        <!-- START THEME JS -->
    	<script src="https://cdn.ckeditor.com/4.10.0/full-all/ckeditor.js"></script>
    	
       	<script src="assets/plugins/inputs/js/plugins/sortable.js" type="text/javascript"></script>
	    <script src="assets/plugins/inputs/js/fileinput.js" type="text/javascript"></script>
	    <script src="assets/plugins/inputs/js/locales/fr.js" type="text/javascript"></script>
	    <script src="assets/plugins/inputs/js/locales/es.js" type="text/javascript"></script>
	    
    	<script src="assets/js/popper.min.js" type="text/javascript"></script>
<title>Nouvelle arret&eacute;</title>
</head>
<body class="hold-transition fixed sidebar-mini">
        
        <!-- Preloader -->
        <div class="preloader"></div>
        
        <!-- Site wrapper -->
        <!-- Content Wrapper. Contains page content -->
        <div th:replace="fragments/header :: header">Static header</div>   
      <!--  --> 
      <div class="content-wrapper">
                <!-- Main content -->
                <div class="content">
                    <div class="row">
                        <div class="col-sm-12"> 

	                            <div class="mailbox">
	                                <div class="mailbox-header">
	                                    <div th:object="${arreteEqRefForm}"  class="row">
	                                        <div class="col-xs-4">
	                                            <div class="inbox-avatar"><img src="assets/dist/img/logo.png" class="img-circle border-green" alt="img">
	                                                <div class="inbox-avatar-text hidden-xs hidden-sm">
	                                                    <div class="avatar-name">Cr&eacute;ation de l'Arr&ecirc;t&eacute; d'&eacute;quivalence</div>
	                                                    <div>TITRE: <small th:text="*{titre}+' anneé: '+*{anneeSortie}"></small></div>
	                                                </div>
	                                            </div>
	                                        </div>
	                                        <div class="col-xs-8">
	                                            <div class="inbox-toolbar btn-toolbar">
	                                                <div class="btn-group">
	                                                 	<input type="submit" class="btn btn-default  w-md m-rb-5" value="Sauvegarder"></a>
	                                                    <a class="btn btn-primary w-md m-rb-5" data-toggle="modal" data-target="#myModal">Renommer ce titre</a>
	                                                    <a href="/listArrete" class="hidden-xs hidden-sm btn btn-default"><span class="fa fa-reply-all"></span></a>
	                                                </div>
	                                            </div>
	                                        </div>
	                                    </div>
	                                </div>
	                                <div class="mailbox-body">
	                                    <div class="row m-0">
	                                        <div class="col-sm-3 p-0 inbox-nav hidden-xs hidden-sm">
	                                            <div class="mailbox-sideber">
	                                                <div class="profile-usermenu">
	                                                    <h6>En-t&ecirc;te</h6>
	                                                    <ul class="nav nav-tabs tabs-left">
	                                                    	<li class="active"><a href="#tab1" data-toggle="tab"><i class="fa fa-inbox"></i>Logo-dgfop</a></li>
	                                    				</br>
	                                             		<h6>Loi constitutionnel</h6>
	                                                    
	                                                    	<li><a href="#tab3" data-toggle="tab"><i class="fa fa-inbox"></i>LOI + DECRET</a></li>
	                                					 </br>
	                                             		<h6>Tableau categorie</h6>
	                                                    
	                                                    	<li><a href="#tab4" data-toggle="tab"><i class="fa fa-inbox"></i>TITRE + ORGANISME + CATEGORIE </a></li>
	                                    			     </br>
	                                             		<h6>Articles + lois </h6>
	                                                    	<li><a href="#tab5" data-toggle="tab"><i class="fa fa-inbox"></i>Article(s) + Signature + MINISTRE</a></li>
	      	                                             		
	                                                </div>
	                                            </div>
	                                        </div>
	                                        
	                                        <div class="col-xs-12 col-sm-12 col-md-9 p-0 inbox-mail p-20  tab-content">
	                                            
	                                            <!-- En-tête -->
	                                            <div class="tab-pane fade in active" id="tab1">
				                                    <form th:object="${enteteArreteForm}" th:action="@{/saveEntete}+ '/' + ${arreteEqRefForm.id}" method="POST" enctype="multipart/form-data" class="formEntete">
				                                      	
				                                      	<div th:if="${#fields.hasErrors('*')}" class="alert alert-sm alert-danger alert-dismissible" role="alert">
						                                  	<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
						                                  	<i class="fa fa-exclamation-circle"></i><strong th:text="#{form.hasErrors}" >Error Message!!!</strong> 
						                              	</div>
						                              	        
					                                    <div class="panel-body">
					                                        <p><strong>En-t&ecirc;te arr&ecirc;t&eacute; : </strong></p>
				                                        	<h4>Veuillez ajouter un logo : </h4>
				                                        	<div class="form-group">
				                                                <div class="input-group">
				                                                    <input type="file" class="form-control logo" th:field="*{logo}" name="logo"  >
				                                                    <span class="input-group-addon" id="basic-addon2">LOGO</span>
				                                                </div><!-- /input-group -->
				                                            </div>
				                                        	
															<div class="panel-body">
																<ul class="nav nav-tabs">
																<h4>Titre sur en-t&ecirc;te: </h4>
																	<li><a href="#titre1" data-toggle="tab">Titre gauche</a></li>
		                                                   			<li><a href="#titre2" data-toggle="tab">Titre droite</a></li>
		                                                   		</ul>
	                                                   		
																<div class="tab-content" >
																	<div class="tab-pane fade in active" id="titre1">
						                                    			
																		<div class="form-group row">
																			<textarea type="text"  th:field="*{titreGauche}" id="editor1" ></textarea>
																		</div>
																		
																	</div>
																	<div class="tab-pane fade" id="titre2">
						                                    			
																		<div class="form-group row">
																			<textarea type="text"  th:field="*{titreDroite}" id="editor2" ></textarea>
																		</div>
																		
																	</div>
																	
																</div>
																
																<div id="postResultDiv"></div>
																
																<div class="btn-group pull-right">
																	<button type="submit" class="btn btn-base" onclick="getAlert()">Sauvegarder</button>
																</div>
															</div>
					                                	</div>
				                                	</form>
			                                 	</div>
				                                <div class="tab-pane fade" id="tab3">
				                                    <form   th:action="@{/saveLoiDecret}+ '/' + ${arreteEqRefForm.id}" method="POST" class="formEntete">
				                                      	
				                                      	<!-- <div th:if="${#fields.hasErrors('*')}" class="alert alert-sm alert-danger alert-dismissible" role="alert">
						                                  	<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
						                                  	<i class="fa fa-exclamation-circle"></i><strong th:text="#{form.hasErrors}" >Error Message!!!</strong> 
						                              	</div >-->
						                              	    
					                                    <div class="panel-body">
					                                    	<h4>Loi et d&eacute;cret : </h4>
															<div class="tab-content" >
																<div class="form-group row">
																	<textarea type="text"  id="editor3" ></textarea>
																</div>
															</div>
															<div class="btn-group pull-right">
																<button type="submit" class="btn btn-base" >Sauvegarder</button>
															</div>
					                                	</div>
				                                	</form>
				                                </div>
				                                <div class="tab-pane fade" id="tab4">
				                                    <form   th:action="@{/saveTableauArrete}+ '/' + ${arreteEqRefForm.id}" method="POST" class="formEntete">
					                                   <div class="panel-body">
					                                        <h4>Tableau classificatif de dipl&ocirc;me(par Cat&eacute;gorie): </h4>
				                                        	 
															<textarea type="text"  id="editor4"></textarea>
															<div class="btn-group pull-right">
																<button type="submit" class="btn btn-base" >Sauvegarder</button>
															</div>
				                                    	</div>
			                                    	</form>
				                                </div>

				                                <!-- Tableau categorie -->
				                                <div class="tab-pane fade" id="tab5">
				                                    <form   th:action="@{/saveArticleLoiArrete}+ '/' + ${arreteEqRefForm.id}" method="POST" class="formEntete">
					                                  	<div class="panel-body">
															<ul class="nav nav-tabs">
															<h4>Article + Signature Ministre: </h4> 
																<li><a href="#article1" data-toggle="tab" class="btn btn-default w-md m-rb-5">Article(s)</a></li>
	                                                   			<li><a href="#article2" data-toggle="tab" class="btn btn-default w-md m-rb-5">Signature Ministre</a></li>
                                                   			</ul>
                                                   		
															<div class="tab-content" >
																<div class="tab-pane fade in active" id="article1">
					                                    			
																	<div class="form-group row">
																		<textarea type="text"    id="editor5" ></textarea>
																	</div>
																	
																</div>
																<div class="tab-pane fade" id="article2">
					                                    			
																	<div class="form-group row">
																		<textarea type="text"    id="editor6" ></textarea>
																	</div>
																	
																</div>
																
															</div>
															 
															<div class="btn-group pull-right">
																<button type="submit" class="btn btn-base" >Sauvegarder</button>
															</div>
														</div>
			                                    	</form>
				                                </div>
	                                        </div>
	                                    </div>
	                                </div>
	                            </div> 
                        	
                        </div>
	                        <!-- MODALS DIALOG -->
	             		 	<div class="modal fade" id="myModal" tabindex="-1" role="dialog">
                           	<div class="modal-dialog" role="document">
                               <div class="modal-content">
                                   	 <div class="modal-header">
                                         <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                         <h1 class="modal-title">Renommer l'arr&ecirc;t&eacute; </h1>
                                     </div>
                                     <form th:object="${arreteEqRefForm}" th:action="@{/updateArrete/}+''+${arreteEqRef.id}" th:method="PUT">
                                     
	                                     <div th:if="${#fields.hasErrors('*')}" class="alert alert-sm alert-danger alert-dismissible" role="alert">
		                                  	<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
		                                  	<i class="fa fa-exclamation-circle"></i><strong th:text="#{form.hasErrors}" >Error Message!!!</strong> 
		                              	</div>
		                              	
	                                     <div class="modal-body">
	                                      	<div class="form-group row">
		                                        <label for="example-text-input" class="col-sm-3 col-form-label">N° identifiant:</label>
		                                        <div class="col-sm-9">
		                                            <input class="form-control" type="text" th:field="*{id}" id="example-text-input"  disabled>
		                                        </div>
		                                    </div>
	                                        <div class="form-group row">
		                                        <label for="example-text-input" class="col-sm-3 col-form-label">Nommer le titre de l'Arr&ecirc;t&eacute; :</label>
		                                        <div class="col-sm-9">
		                                            <input class="form-control" type="text" th:field="*{titre}" id="example-text-input" placholder="Titre de l'arrêté d'équivalence ..." required>
		                                        </div>
		                                    </div>
		                                     	
			                              	<div class="form-group row">
			                                	<div th:if="${not #lists.isEmpty(listeDiploma)}">
			                                        <label class="col-sm-3 col-form-label">Veuillez selectionner un dipl&ocirc;me </label>
			                                        <div class="col-sm-7">
			                                            <select class="form-control basic-single" th:field="*{listesDiplome}">
			                                            	<div th:each="ecole : ${listEcole}">
			                                            		<optgroup th:label="'Ecole délivreur '+${ecole} + ' : '">
			                                            			<div th:each="diplome : ${listeDiploma}">
			                                            				<div th:if="${ecole == diplome.ecole}">
					                                           				<option th:value="${diplome.id}" th:text="${diplome.niveauDiplome.niveau} + ' EN ' + ${diplome.filiere} + ' option:' + ${diplome.option} "></option>
					                                           			</div>
					                                           		</div>
					                                           	</optgroup>
			                                            	</div>
			                                            </select>
			                                        </div>
			                                    </div>
												<div class="col-sm-1 col-form-label"><b><a href="/newDiploma" data-toggle="tooltip" data-placement="right" title="Ajouter une nouvelle Diplome" th:text="'Nouveau!!!'"></a></b></div>
			                                </div>
		                                    <div class="form-group row">
		                                        <label class="col-sm-3 col-form-label">Anne&eacute; sortie</label>
		                                        <div class="col-sm-7">
		                                            <select class="form-control basic-single" th:field="*{anneeSortie}">
		                                                <option disabled="disabled" selected="selected" th:value="${#calendars.format(#calendars.createNow(), 'yyyy')}" th:text="'Sortie le'"></option>
		                                                <!--placeholder-->
		                                                <div th:each="annee : ${annees}">
		                                                	<option th:value="${annee}" th:text="${annee}"></option>
		                                                </div>
		                                            </select>
		                                        </div>
		                                    </div>
	                                     </div>
	                                     <div class="modal-footer">
	                                         <button type="submit" class="btn btn-base">Ok</button>
                                             <button type="button" class="btn btn-danger" data-dismiss="modal">Annuler</button>
	                                     </div>
                                     </form>
                                 </div><!-- /.modal-content -->
                             </div><!-- /.modal-dialog -->
                         </div><!-- /.modal --> 
                    </div>
                </div>
            </div>
       	<div th:replace="fragments/footer :: footer">&copy; 2018 The Static Templates</div>
        
        <!-- ./²wrapper -->
        <!-- START CORE PLUGINS -->
     
       	
       	<script>
       		//entete
			CKEDITOR.replace( 'editor1' );
			CKEDITOR.replace( 'editor2' );
			
			//Loi+decret
			CKEDITOR.replace( 'editor3' );
			
			//Tableau
			CKEDITOR.replace( 'editor4' );
			
			//article + signature
			CKEDITOR.replace( 'editor5' );
			CKEDITOR.replace( 'editor6' );
		</script>
	  	<script>
			function getAlert(){
				//console.log(CKEDITOR.instances.editor1.getData());
				console.log("\n "+CKEDITOR.instances.editor2.getData());
			//	$('#editor1').val = CKEDITOR.instances.editor1.getData();	
			//	$('#editor2').val = CKEDITOR.instances.editor2.getData();
				$('.formEntete').submit();
				console.log("Hello world!!!!!!!!!!!!!!!!!");
			}
			
			$(document).ready(function() {
				
				// SUBMIT FORM
				/*$(".formEntete").submit(function(event) {
					// Prevent the form from submitting via the browser.
					event.preventDefault();
					ajaxPost();
					
				});*/
		        
			});
			
			function ajaxPost() {
				// PREPARE FORM DATA
				var formData1 = CKEDITOR.instances.editor1.getData();
				var formData2 = CKEDITOR.instances.editor2.getData();
				var image = $("input[type='file']").val();
				var f = $("input[type='file']")[0].files[0]; 
				
				//var formData = new FormData();
				//formData.append('logo', $("input[type='file']")[0].files[0]);
					if (f) {
					    var reader = new FileReader();
					    reader.readAsDataURL(f);
					    reader.onload = function(e) {
					    	var image = e.target.result;
					    	var $data = { 'titreGauche': formData1, 'titreDroite': formData2, 'logo': image };
					    	
						$.ajax({
							type : "POST",
							contentType : "text/html",
							url : $(".formEntete").attr("action"),
							data : $data,
							dataType : 'text',
							success : function(result) {
								$("#postResultDiv")
									.html("<div class=\"alert alert-sm alert-info alert-dismissible\" role=\"alert\"><button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button><i class=\"fa fa-exclamation-circle\"></i><strong>INFO :</strong> Sauvegarde reussie!</div> ");
							 
								console.log("SUCCESS!!!");
								//window.location.replace($(".formEntete").attr("action"));
							},
							error : function(e) {
								alert("Error!")
								console.log("ERROR: ", e);
							}
						});
					        alert(e.target.result);
					    };
					}
				}
		</script>
		
        <script src="assets/plugins/jQuery/jquery-1.12.4.min.js"></script>
        <script src="assets/plugins/jquery-ui-1.12.1/jquery-ui.min.js"></script>
        
      
        <script src="assets/bootstrap/js/bootstrap.min.js"></script>
        <script src="assets/plugins/slimScroll/jquery.slimscroll.min.js"></script>
        <script src="assets/plugins/fastclick/fastclick.min.js"></script>
        <script src="assets/plugins/metisMenu/metisMenu.min.js"></script>
        <script src="assets/plugins/lobipanel/lobipanel.min.js"></script>
        <!-- Summernote Js -->
        <script src="assets/plugins/summernote/summernote.js"></script>
        <script src="assets/plugins/summernote/summernote-active.js"></script>
        <!-- modals js -->
        <script src="assets/plugins/modals/classie.js"></script>
        <script src="assets/plugins/modals/modalEffects.js"></script>
        <!-- START THEME LABEL SCRIPT -->
        <script src="assets/dist/js/theme.js"></script>
	</body>
	
</html>